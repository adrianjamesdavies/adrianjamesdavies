https://www.vulnhub.com/entry/the-planets-earth,755/

## Description:

This is an easy challenge
The goal is to gain root access by any means necessary (except actually hacking the VM server or player).
The goal of these games is to teach you the fundamental tools and strategies for assessing and exploiting vulnerabilities.
There are a variety of approaches to completing the challenges.

### stage one - enumeration:

first we need to find the machine - which is a vmware workstation image

so quick nmap scan
nmap 192.168.1.0/24

so:
Nmap scan report for earth.fritz.box (192.168.1.102)
Host is up (0.00037s latency).
Not shown: 858 filtered tcp ports (no-response), 139 filtered tcp ports (admin-prohibited)
PORT    STATE SERVICE
22/tcp  open  ssh
80/tcp  open  http
443/tcp open  https
MAC Address: 08:00:27:DF:AC:A3 (Oracle VirtualBox virtual NIC)

so this box is going to be a webvuln box

access http://192.168.1.102 - just gives bad request and a default page on https

lets run nikto thru it to see what we get back

nikto -h 192.168.1.102

### result 

nikto -h 192.168.1.102
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.1.102
+ Target Hostname:    192.168.1.102
+ Target Port:        80
+ Start Time:         2022-03-18 11:57:17 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.51 (Fedora) OpenSSL/1.1.1l mod_wsgi/4.7.1 Python/3.9
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ Cookie csrftoken created without the httponly flag
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ OSVDB-3268: /icons/: Directory indexing found.
+ OSVDB-3233: /icons/README: Apache default file found.
+ 8723 requests: 0 error(s) and 6 item(s) reported on remote host
+ End Time:           2022-03-18 11:58:52 (GMT-4) (95 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested


      *********************************************************************
      Portions of the server's headers (Python/3.9 mod_wsgi/4.7.1 Apache/2.4.51) are not in
      the Nikto 2.1.6 database or are newer than the known string. Would you like
      to submit this information (*no server specific data*) to CIRT.net
      for a Nikto update (or you may email to sullo@cirt.net) (y/n)? y

+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The site uses SSL and the Strict-Transport-Security HTTP header is not defined.
+ The site uses SSL and Expect-CT header is not present.
- Sent updated info to cirt.net -- Thank you!

not a lot to be fair. version of apache is farly new - so no vulns there

lets see what other files are on the webserver?
gobuster dir -u http://192.168.1.102 -x html,txt,php,bak --wordlist=/usr/share/wordlists/dirb/common.txt
that didnt give me anything!

so let go back to the ssl site
and check out the cert i get the following:
DNS Name
earth.local
DNS Name
terratest.earth.local

so lets add these to the hostname file
and now we get a website - which is a messaging service 

└─# gobuster dir -u https://earth.local -x html,txt,php,bak --wordlist=/usr/share/wordlists/dirb/common.txt -k
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     https://earth.local
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              bak,html,txt,php
[+] Timeout:                 10s
===============================================================
2022/03/18 12:17:30 Starting gobuster in directory enumeration mode
===============================================================
/admin                (Status: 301) [Size: 0] [--> /admin/]
/cgi-bin/.html        (Status: 403) [Size: 199]            
/cgi-bin/             (Status: 403) [Size: 199]   

so there is a admin page!
http://terratest.earth.local/admin/login












